# ๐ ุณุงูุงูู ุงุฑุณุงู ูุดุฏุงุฑ ูุจุชู ุจุฑ SMTP (ClientโServer)

## ๐ ูุนุฑู ูพุฑูฺู

ุงู ูพุฑูฺู ฺฉ ูพุงุฏูโุณุงุฒ ุขููุฒุด ู ุนูู ุงุฒ ฺฉ **ุณุงูุงูู ุงุฑุณุงู ูุดุฏุงุฑ ูุจุชู ุจุฑ ูุนูุงุฑ ClientโServer** ุงุณุช ฺฉู ุจุง ุงููุงู ุงุฒ ุนููฺฉุฑุฏ ูุงูุน ุฏุณุชฺฏุงูโูุง ูุธุงุฑุช ูุงููุฏ **DVR / NVR** ุทุฑุงุญ ุดุฏู ุงุณุช.
ูพุฑูฺู ุฏุฑ ูุงูุจ ุฏุฑุณ **ูููุฏุณ ุงูุชุฑูุช** ุชูุณุนู ุฏุงุฏู ุดุฏู ู ูุฏู ุขูุ ุฏุฑฺฉ ุนูู ููุงูู **ูุงู ฺฉุงุฑุจุฑุฏ (Application Layer)**ุ ุงุฑุชุจุงุทุงุช ุดุจฺฉูโุง ูุจุชู ุจุฑ **TCP** ู ุงุณุชูุงุฏู ุนูู ุงุฒ ูพุฑูุชฺฉู **SMTP** ูโุจุงุดุฏ.

ุฏุฑ ุงู ุณุงูุงููุ ฺฉ ฺฉูุงูุช (ุดุจูโุณุงุฒ DVR) ุฑูุฏุงุฏูุง ูุธุงุฑุช ุฑุง ุชููุฏ ฺฉุฑุฏู ู ุงุฒ ุทุฑู ฺฉ ุงุชุตุงู TCP ุจู ุณุฑูุฑ ุงุฑุณุงู ูโฺฉูุฏ. ุณุฑูุฑ ูพุณ ุงุฒ ูพุฑุฏุงุฒุด ุฑูุฏุงุฏุ ูุดุฏุงุฑ ูุฑุจูุทู ุฑุง ุงุฒ ุทุฑู ุงูู ุจุฑุง ฺฉุงุฑุจุฑ ููุง ุงุฑุณุงู ูโููุงุฏ.

---

## ๐ฏ ุงูุฏุงู ูพุฑูฺู

ุงูุฏุงู ุงุตู ุงู ูพุฑูฺู ุนุจุงุฑุชโุงูุฏ ุงุฒ:

* ุฏุฑฺฉ ุนูู ูุนูุงุฑ **ClientโServer**
* ูพุงุฏูโุณุงุฒ ุงุฑุชุจุงุท ุดุจฺฉูโุง ุจุง ุงุณุชูุงุฏู ุงุฒ **TCP Socket**
* ุขุดูุง ุจุง ูุญูู ุนููฺฉุฑุฏ ูุงูุน **SMTP** ุฏุฑ ุณุงูุงููโูุง ูุดุฏุงุฑ
* ุงูุชูุงู ุฏุงุฏูโูุง ุณุงุฎุชโุงูุชู ุจุง **JSON**
* ุงุฑุณุงู ุฏุงุฏูโูุง ุจุงูุฑ (ุชุตูุฑ) ุจุง ุงุณุชูุงุฏู ุงุฒ **Base64**
* ุดุจูโุณุงุฒ ฺฉ ุณูุงุฑู ูุงูุน ุงุฒ ุณุณุชูโูุง ูุธุงุฑุช ุฎุงูฺฏ

---

## ๐งฑ ูุนูุงุฑ ฺฉู ุณุณุชู

```text
DVR Client  โ  TCP Socket  โ  Alert Server  โ  SMTP  โ  User Email
```

### ุงุฌุฒุง ุณุณุชู:

* **Client (client.py)**
  ุดุจูโุณุงุฒ ุฏุณุชฺฏุงู DVR ฺฉู ุฑูุฏุงุฏูุง ุฑุง ุชููุฏ ู ุงุฑุณุงู ูโฺฉูุฏ.

* **Server (server.py)**
  ุณุฑูุฑ ูุฑฺฉุฒ ฺฉู ุฑูุฏุงุฏูุง ุฑุง ุฏุฑุงูุชุ ุชุญูู ู ูพุฑุฏุงุฒุด ูโฺฉูุฏ.

* **SMTP Module (smtp_module.py)**
  ูุงฺูู ูุณุชูู ุงุฑุณุงู ุงูู ุจุง ูพุดุชุจุงู ุงุฒ ุญุงูุช ูุงูุน ู ุญุงูุช ุชุณุช (Debug).

---

## ๐จ ุทุฑุงุญ ูพุฑูุชฺฉู ูพุงู

ุจุฑุง ุณุงุฏฺฏุ ุฎูุงูุง ู ูุงุจูุช ุชูุณุนูุ ูพุงูโูุง ุฏุฑ ูุงูุจ **JSON** ุงุฑุณุงู ูโุดููุฏ.
ููููู ุณุงุฎุชุงุฑ ูพุงู:

```json
{
  "event": "MOTION_DETECTED",
  "camera": "cam1",
  "timestamp": "2025-01-01T12:00:00Z",
  "image_filename": "image.jpg",
  "image_b64": "BASE64_ENCODED_DATA"
}
```

### ุชูุถุญ ููุฏูุง:

| ููุฏ           | ุชูุถุญ                                          |
| -------------- | ---------------------------------------------- |
| event          | ููุน ุฑูุฏุงุฏ (ุญุฑฺฉุชุ ุจุงุฒ ุดุฏู ุฏุฑุจุ ูุทุน ุงุฑุชุจุงุท ู โฆ) |
| camera         | ุดูุงุณู ุง ูุงู ุฏูุฑุจู                            |
| timestamp      | ุฒูุงู ูููุน ุฑูุฏุงุฏ (UTC)                         |
| image_filename | ูุงู ูุงู ุชุตูุฑ (ุงุฎุชุงุฑ)                       |
| image_b64      | ุชุตูุฑ ฺฉุฏฺฏุฐุงุฑโุดุฏู ุจุง Base64 (ุงุฎุชุงุฑ)          |

---

## ๐ฅ๏ธ ูุญูู ุงุฌุฑุง ูพุฑูฺู

### ๐น ุงุฌุฑุง ุญุงูุช ุชุณุช (SMTP Debug)

ุฏุฑ ุงู ุญุงูุช ุงูู ูุงูุน ุงุฑุณุงู ููโุดูุฏ ู ุฎุฑูุฌ ุฏุฑ ุชุฑููุงู ููุงุด ุฏุงุฏู ูโุดูุฏ.

**ุชุฑููุงู A โ ุงุฌุฑุง SMTP Debug Server**

```bash
python -m aiosmtpd -n -l localhost:1025 --debug
```

**ุชุฑููุงู B โ ุงุฌุฑุง ุณุฑูุฑ**

```bash
python server.py
```

**ุชุฑููุงู C โ ุงุฑุณุงู ุฑูุฏุงุฏ ุงุฒ ุณูุช ฺฉูุงูุช**

```bash
python client.py --event MOTION_DETECTED --camera cam1
```

---

### ๐น ุงุฌุฑุง ุญุงูุช ูุงูุน (ุงุฑุณุงู ุงูู)

ุจุฑุง ุงุฑุณุงู ุงูู ูุงูุนุ ูุชุบุฑูุง ูุญุท ุฒุฑ ุจุงุฏ ุชูุธู ุดููุฏ:

```bash
export SMTP_HOST="smtp.gmail.com"
export SMTP_PORT="465"
export SMTP_USER="your@gmail.com"
export SMTP_PASS="app_password"
export ALERT_RECIPIENT="receiver@example.com"
```

ุณูพุณ ุณุฑูุฑ ู ฺฉูุงูุช ุฑุง ุงุฌุฑุง ฺฉูุฏ.

---

## ๐จ ููููู ุฑูุฏุงุฏูุง ูุงุจู ุงุฑุณุงู

ุจุฑุฎ ุงุฒ ุฑูุฏุงุฏูุง ุฑุงุฌ ฺฉู ุฏุฑ ุงู ุณุงูุงูู ูพุดุชุจุงู ูโุดููุฏ:

* `MOTION_DETECTED` โ ุชุดุฎุต ุญุฑฺฉุช
* `DOOR_OPENED` โ ุจุงุฒ ุดุฏู ุฏุฑุจ
* `CAMERA_DISCONNECTED` โ ูุทุน ุงุฑุชุจุงุท ุฏูุฑุจู
* `CAMERA_RECONNECTED` โ ุงุชุตุงู ูุฌุฏุฏ ุฏูุฑุจู
* `TAMPER_DETECTED` โ ุฏุณุชฺฉุงุฑ ูุฒฺฉ ุฏูุฑุจู
* `SYSTEM_RESTARTED` โ ุฑุงูโุงูุฏุงุฒ ูุฌุฏุฏ ุณุณุชู

---

## ๐ ููุงุญุธุงุช ุงููุช

* ุงุทูุงุนุงุช ุญุณุงุณ SMTP ุงุฒ ุทุฑู **Environment Variables** ูุฏุฑุช ูโุดูุฏ.
* ุงุฑุชุจุงุท TCP ุฏุฑ ุงู ูพุฑูฺู ุขููุฒุด ุฑูุฒูฺฏุงุฑ ูุดุฏู ุงุณุช.
* ุฏุฑ ูุณุฎูโูุง ูุงูุน ูโุชูุงู ุงุฒ **TLSุ ุงุญุฑุงุฒ ููุช ฺฉูุงูุช ู Token ุงููุช** ุงุณุชูุงุฏู ฺฉุฑุฏ.
* ุงุฑุณุงู ุชุตูุฑ ุจุงุนุซ ุงูุฒุงุด ุญุฌู ูพุงู ูโุดูุฏุ ุฏุฑ ุณุงูุงููโูุง ุตูุนุช ูุนูููุงู ููฺฉ ูุงู ุงุฑุณุงู ูโุดูุฏ.

---

## ๐งฉ ุฌูุนโุจูุฏ

ุงู ูพุฑูฺู ฺฉ ููููู ุขููุฒุด ฺฉุงูู ุงุฒ ฺฉุงุฑุจุฑุฏ ููุงูู ูููุฏุณ ุงูุชุฑูุช ุฏุฑ ฺฉ ุณูุงุฑู ูุงูุน ุงุณุช.
ูุณุฎู ูพุงุฏูโุณุงุฒโุดุฏู ุจุง Pythonุ **ูุฏู ูุฑูโุงูุฒุงุฑ ู ุขููุฒุด ุงุฒ ุนููฺฉุฑุฏ ูุงูุน ุณุณุชูโูุง DVR/NVR** ูุญุณูุจ ูโุดูุฏ ู ููุงูู ูุงููุฏ TCPุ SMTPุ ูุนูุงุฑ ClientโServer ู ูุฏุฑุช ุฏุงุฏู ุฏุฑ ูุงู ฺฉุงุฑุจุฑุฏ ุฑุง ุจูโุตูุฑุช ุนูู ููุงุด ูโุฏูุฏ.

---

## ๐ค ุชูุณุนูโุฏููุฏู

**ูุญูุฏ ูพูููุงูุงู**
ุฏุฑุณ ูููุฏุณ ุงูุชุฑูุช โ ุชุฑู ููุฑ ฑดฐด
